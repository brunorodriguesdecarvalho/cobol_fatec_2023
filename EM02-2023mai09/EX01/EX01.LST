* Microsoft COBOL Version 4.5        L2.4 revision 002 11-Mar-23 14:42 Page   1
*                                       EX01.CBL
* Options: LIST(EX01.LST) ASMLIST(EX01.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. EX01.
     3 AUTHOR. BRUNO RODRIGUES DE CARVALHO.
     4 INSTALLATION. FATEC-SP.
     5 DATE-WRITTEN. 11/03/2023.
     6 DATE-COMPILED. 11-Mar-23 14:42.
     7
     8 ENVIRONMENT DIVISION.
     9
    10 CONFIGURATION SECTION.
    11 SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    12
    13 INPUT-OUTPUT SECTION.
    14
    15 FILE-CONTROL.
    16     SELECT CADSOC1 ASSIGN TO 'CADSOC1.DAT'
    17     ORGANIZATION IS LINE SEQUENTIAL.
    18
    19     SELECT CADSOC2 ASSIGN TO 'CADSOC2.DAT'
    20     ORGANIZATION IS LINE SEQUENTIAL.
    21
    22     SELECT RELSOCIO-OUT ASSIGN TO 'RELSOCIO.TXT'
    23     ORGANIZATION IS LINE SEQUENTIAL.
    24
    25 DATA DIVISION.
    26
    27 FILE SECTION.
    28 FD CADSOC1.
    29 01 REG-SOCIO.
    30     02 COD-PAGAMENTO1 PIC 9(02).
    31     02 NUMERO-SOCIO1 PIC 9(06).
    32     02 NOME-SOCIO1 PIC X(30).
    33     02 VALOR-PAGAMENTO1 PIC 9(02)V9(02).
    34
    35 FD CADSOC2.
    36 01 REG-SOCIO-PAGO.
    37     02 NUMERO-SOCIO2 PIC 9(06).
    38     02 NOME-SOCIO2 PIC X(30).
    39     02 VALOR-PAGAMENTO2 PIC 9(02)V9(02).
    40
    41 FD RELSOCIO.
*  12-S***********                                                     (   0)**
**    Operand  is not declared
    42 01 REL-SOCIO-REC.
    43     02 REL-SOCIO-LINHA PIC X(80).
    44
    45 WORKING-STORAGE SECTION.
    46 01 TEMP-RELSOCIO.
    47     02 TEMP-REL-SOCIO-LINHA PIC X(80).
    48     02 WS-LINHA-DETALHE PIC X(80).
    49     02 WS-PAGINA PIC 9(02) VALUE 0.
    50     02 WS-CONTADOR PIC 9(02) VALUE 0.
    51     02 WS-QTDE-SOCIOS-ATRASADOS PIC 9(03) VALUE 0.
    52     02 WS-QTDE-SOCIOS-EM-DIA PIC 9(03) VALUE 0.
    53     02 WS-VALOR-TOTAL PIC 9(07)V99 VALUE 0.
    54     02 FIM-ARQ PIC X VALUE 'N'.
    55     02 TITULO1 PIC X(80) VALUE 'Relatório de Sócios Atrasados'.
* Microsoft COBOL Version 4.5        L2.4 revision 002 11-Mar-23 14:42 Page   2
*                                       EX01.CBL
    56     02 TITULO2 PIC X(80) VALUE 'Numero do Sócio'.
    57     02 TITULO3 PIC X(80) VALUE 'Nome do Sócio'.
    58     02 LINHA-VAZIA PIC X(80) VALUE ALL '-'.
    59     02 LINHA-VAZIA-DETALHE PIC X(80) VALUE ALL '-'.
    60
*      RELSOCIO-OUT
* 244-S************                                                    (   1)**
**    FD missing for file RELSOCIO-OUT
    61 PROCEDURE DIVISION.
    62
    63 MAIN-LOGIC.
    64     OPEN INPUT CADSOC1
    65          OUTPUT CADSOC2
    66          OUTPUT RELSOCIO.
*  12-S************************                                        (   2)**
**    Operand  is not declared
    67
    68     WRITE REL-SOCIO-REC FROM TITULO1.
* 330-S***********************                                         (   2)**
**    Not a record name
    69     WRITE REL-SOCIO-REC FROM TITULO2.
* 330-S***********************                                         (   2)**
**    Not a record name
    70     WRITE REL-SOCIO-REC FROM TITULO3.
* 330-S***********************                                         (   2)**
**    Not a record name
    71
    72     PERFORM UNTIL FIM-ARQ = 'S'
    73         READ CADSOC1
    74             AT END
    75                 MOVE 'S' TO FIM-ARQ(1:1)
    76             NOT AT END
    77                 IF COD-PAGAMENTO1 = 1
    78                     PERFORM GRAVA-CADSOC2
    79                 ELSE
    80                     PERFORM IMPRIME-RELSOCIO
    81                 END-IF
    82                 IF WS-CONTADOR = 30
    83                     PERFORM IMPRIME-CABECALHO
    84                     MOVE 0 TO WS-CONTADOR
    85                 END-IF
    86         END-READ
    87     END-PERFORM.
    88
    89     CLOSE CADSOC1
    90           CADSOC2
    91           RELSOCIO.
* 301-S******************                                              (   2)**
**    Unrecognized verb
    92
    93     STOP RUN.
    94
    95 GRAVA-CADSOC2.
    96     MOVE NUMERO-SOCIO1 TO NUMERO-SOCIO2.
    97     MOVE NOME-SOCIO1 TO NOME-SOCIO2.
    98     WRITE REG-SOCIO-PAGO.
    99
   100 IMPRIME-RELSOCIO.
* Microsoft COBOL Version 4.5        L2.4 revision 002 11-Mar-23 14:42 Page   3
*                                       EX01.CBL
   101     IF COD-PAGAMENTO1 = 2
   102        IF WS-CONTADOR = 0
   103           PERFORM IMPRIME-CABECALHO
   104        END-IF.
   105
   106        ADD 1 TO WS-QTDE-SOCIOS-ATRASADOS.
   107        COMPUTE WS-VALOR-TOTAL = WS-VALOR-TOTAL + VALOR-PAGAMENTO1
   108
   109        MOVE NUMERO-SOCIO1 TO WS-LINHA-DETALHE(1:6).
   110        MOVE NOME-SOCIO1 TO WS-LINHA-DETALHE(8:30).
   111        MOVE FUNCTION STRING(VALOR-PAGAMENTO1, "9(2)V9(2)")
*  72-S***************************                                     (   2)**
**    Invalid FUNCTION name
   112        TO WS-LINHA-DETALHE(60:5).
   113
   114        WRITE RELSOCIO FROM WS-LINHA-DETALHE.
*  12-S*********************                                           (   3)**
**    Operand  is not declared
   115
   116        ADD 1 TO WS-CONTADOR.
   117
   118        IF WS-CONTADOR = 30
   119           PERFORM IMPRIME-TOTAIS
   120           PERFORM IMPRIME-CABECALHO
   121        END-IF.
   122
   123        IF WS-QTDE-SOCIOS-ATRASADOS = 0 AND WS-CONTADOR = 0
   124           WRITE REL-SOCIO-OUT FROM LINHA-VAZIA
*  12-S*****************************                                   (   3)**
**    Operand  is not declared
   125        END-IF.
   126
   127        IF WS-QTDE-SOCIOS-ATRASADOS = 0 AND WS-CONTADOR > 0
   128           WRITE REL-SOCIO-OUT FROM LINHA-VAZIA-DETALHE
*  12-S*****************************                                   (   3)**
**    Operand  is not declared
   129        END-IF.
   130     END-IF.
* 564-S**********                                                      (   3)**
**    A scope-delimiter did not have a matching verb and was discarded.
   131
   132 IMPRIME-CABECALHO.
   133     ADD 1 TO WS-PAGINA.
   134     MOVE 'Relatório de Sócios Atrasados' TO WS-LINHA-DETALHE.
   135     WRITE RELSOCIO FROM WS-LINHA-DETALHE.
*  12-S******************                                              (   3)**
**    Operand  is not declared
   136     MOVE SPACES TO WS-LINHA-DETALHE.
   137     MOVE 'Pagina ' TO WS-LINHA-DETALHE(1:7).
   138     MOVE WS-PAGINA TO WS-LINHA-DETALHE(8:2).
   139     WRITE TEMP-RELSOCIO FROM WS-LINHA-DETALHE.
* 330-S***********************                                         (   3)**
**    Not a record name
   140     MOVE SPACES TO WS-LINHA-DETALHE.
   141     MOVE 'Numero do Sócio' TO WS-LINHA-DETALHE(1:17).
   142     MOVE 'Nome do Sócio' TO WS-LINHA-DETALHE(19:12).
   143     MOVE 'Valor do Pagamento' TO WS-LINHA-DETALHE(32:18).
   144     WRITE TEMP-RELSOCIO FROM WS-LINHA-DETALHE.
* Microsoft COBOL Version 4.5        L2.4 revision 002 11-Mar-23 14:42 Page   4
*                                       EX01.CBL
* 330-S***********************                                         (   3)**
**    Not a record name
   145     MOVE SPACES TO WS-LINHA-DETALHE.
   146     WRITE TEMP-RELSOCIO FROM WS-LINHA-DETALHE.
* 330-S***********************                                         (   3)**
**    Not a record name
   147     MOVE SPACES TO WS-LINHA-DETALHE.
   148     MOVE TEMP-REL-SOCIO-LINHA TO REL-SOCIO-LINHA.
   149     WRITE RELSOCIO-OUT FROM REL-SOCIO-LINHA.
* 330-S**********************                                          (   4)**
**    Not a record name
   150
   151 IMPRIME-TOTAIS.
   152     ADD WS-QTDE-SOCIOS-ATRASADOS TO WS-QTDE-SOCIOS-EM-DIA.
   153     MOVE SPACES TO WS-LINHA-DETALHE.
   154     WRITE RELSOCIO-OUT FROM WS-LINHA-DETALHE.
* 330-S**********************                                          (   4)**
**    Not a record name
   155     MOVE 'Total de sócios atrasados: ' TO WS-LINHA-DETALHE(1:38)
   156     MOVE WS-QTDE-SOCIOS-ATRASADOS TO WS-LINHA-DETALHE(39:3).
   157     MOVE SPACES TO WS-LINHA-DETALHE(42:16).
   158     MOVE 'Valor total atrasado: R$ ' TO WS-LINHA-DETALHE(58:25).
   159     MOVE WS-VALOR-TOTAL TO WS-LINHA-DETALHE(84:8).
*1029-E************************************************                (   4)**
**    A non-integer is being moved to an alphanumeric data item
   160     WRITE RELSOCIO-OUT FROM WS-LINHA-DETALHE.
* 330-S**********************                                          (   4)**
**    Not a record name
   161
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Last message on page:  4
*
* Total Messages:    20
* Unrecoverable :     0                    Severe  :    19
* Errors        :     1                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:        1720     Code:         805     Dictionary:        1901
