* Microsoft COBOL Version 4.5        L2.4 revision 002 19-Jun-23 10:38 Page   1
*                                      TESTE.CBL
* Options: LIST(TESTE.LST) ASMLIST(TESTE.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. teste.
     3 AUTHOR.        HIRO.
     4 INSTALLATION.  BRUNO-PC.
     5 DATE-WRITTEN.  17/09/2004.
     6 DATE-COMPILED. 19-Jun-23 10:38.
     7 SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8
     9 ENVIRONMENT DIVISION.
    10 CONFIGURATION SECTION.
    11 SOURCE-COMPUTER. BRUNO-PC.
    12 OBJECT-COMPUTER. BRUNO-PC.
    13 SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    14
    15 INPUT-OUTPUT SECTION.
    16 FILE-CONTROL.
    17     SELECT MVTO ASSIGN TO DISK
    18     ORGANIZATION IS LINE SEQUENTIAL.
    19
    20     SELECT ANT ASSIGN TO DISK
    21     ORGANIZATION IS LINE SEQUENTIAL.
    22
    23     SELECT ATU ASSIGN TO DISK
    24     ORGANIZATION IS LINE SEQUENTIAL.
    25
    26 DATA DIVISION.
    27 FILE SECTION.
    28
    29 FD MVTO
    30     LABEL RECORD ARE STANDARD
    31     VALUE OF FILE-ID IS "MVTO.DAT".
    32 01 REG-MVTO.
    33     02 COD-MVTO  PIC 9(04).
    34     02 NOME-MVTO PIC X(30).
    35
    36 FD ANT
    37     LABEL RECORD ARE STANDARD
    38     VALUE OF FILE-ID IS "ANT.DAT".
    39 01 REG-ANT.
    40     03 COD-ANT  PIC 9(04).
    41     03 NOME-ANT PIC X(30).
    42
    43 FD ATU
    44     LABEL RECORD ARE STANDARD
    45     VALUE OF FILE-ID IS "ATU.DAT".
    46 01 REG-ATU.
    47     03 COD-ATU  PIC 9(04).
    48     03 NOME-ATU PIC X(30).
    49
    50 WORKING-STORAGE SECTION.
    51 77 CH-MVTO PIC X(04) VALUE SPACES.
    52 77 CH-ANT  PIC X(04) VALUE SPACES.
    53
    54 PROCEDURE DIVISION.
    55
    56 PGM-TESTE.
    57     PERFORM INICIO.
* Microsoft COBOL Version 4.5        L2.4 revision 002 19-Jun-23 10:38 Page   2
*                                      TESTE.CBL
    58     PERFORM PRINCIPAL
    59         UNTIL
    60         CH-MVTO EQUAL CH-ANT AND
    61         CH-ANT EQUAL HIGH-VALUES.
    62     PERFORM FIM.
    63     STOP RUN.
    64
    65 INICIO.
    66     OPEN INPUT  MVTO
    67                 ANT
    68          OUTPUT ATU.
    69     PERFORM LER-MVTO.
    70     PERFORM LER-ANT.
    71
    72 LER-MVTO.
    73     READ MVTO
    74          AT END
    75          MOVE HIGH-VALUES TO CH-MVTO.
    76
    77     IF CH-MVTO EQUAL HIGH-VALUES
    78         NEXT SENTENCE
    79     ELSE
    80         MOVE COD-MVTO TO CH-MVTO.
    81
    82 LER-ANT.
    83     READ ANT
    84          AT END
    85          MOVE HIGH-VALUES TO CH-ANT.
    86
    87     IF CH-ANT EQUAL HIGH-VALUES
    88         NEXT SENTENCE
    89     ELSE
    90         MOVE COD-ANT TO CH-ANT.
    91
    92 PRINCIPAL.
    93     IF CH-MVTO EQUAL CH-ANT
    94         PERFORM IGUAL
    95     ELSE
    96     IF CH-MVTO LESS THAN CH-ANT
    97         PERFORM MVTO-MENOR
    98     ELSE
    99         PERFORM ANT-MENOR.
   100
   101 IGUAL.
   102     PERFORM GRAVA-MVTO.
   103     PERFORM GRAVA-ANT.
   104     PERFORM LER-MVTO.
   105     PERFORM LER-ANT.
   106
   107 MVTO-MENOR.
   108     PERFORM GRAVA-MVTO.
   109     PERFORM LER-MVTO.
   110
   111 ANT-MENOR.
   112     PERFORM GRAVA-ANT.
   113     PERFORM LER-ANT.
   114
   115 GRAVA-ANT.
* Microsoft COBOL Version 4.5        L2.4 revision 002 19-Jun-23 10:38 Page   3
*                                      TESTE.CBL
   116     MOVE COD-ANT  TO COD-ATU.
   117     MOVE NOME-ANT TO NOME-ATU.
   118     WRITE REG-ATU.
   119
   120 GRAVA-MVTO.
   121     MOVE COD-MVTO  TO COD-ATU.
   122     MOVE NOME-MVTO TO NOME-ATU.
   123     WRITE REG-ATU.
   124
   125 FIM.
   126     CLOSE MVTO
   127           ANT
   128           ATU.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1248     Code:         557     Dictionary:        1485
