* Microsoft COBOL Version 4.5        L2.4 revision 002 22-Apr-23 16:45 Page   1
*                                       EX04.CBL
* Options: LIST(EX04.LST) ASMLIST(EX04.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. EX04.
     3 AUTHOR. BRUNO CARVALHO.
     4 DATE-WRITTEN. 22/04/2023.
     5 DATE-COMPILED. 22-Apr-23 16:45.
     6 INSTALLATION. BRUNO-PC.
     7 SECURITY. ESSE PROGRAMA SO PODE SER ALTERADO PELO AUTOR.
     8
     9 ENVIRONMENT DIVISION.
    10
    11 CONFIGURATION SECTION.
    12 SOURCE-COMPUTER. BRUNO-PC.
    13 OBJECT-COMPUTER. BRUNO-PC.
    14 SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    15
    16 INPUT-OUTPUT SECTION.
    17
    18 FILE-CONTROL.
    19     SELECT CADESTOQ ASSIGN TO DISK
    20     ORGANIZATION IS LINE SEQUENTIAL.
    21
    22     SELECT RELESTOQ ASSIGN TO DISK.
    23
    24 DATA DIVISION.
    25
    26 FILE SECTION.
    27
    28 FD  CADESTOQ
    29     LABEL RECORD ARE STANDARD
    30     VALUE OF FILE-ID IS "CADESTOQ.DAT".
    31 01  CADESTOQ1.
    32     02 CODIGO-ESTOQ            PIC 9(05).
    33     02 NOME-ESTOQ              PIC X(15).
    34     02 QTDE-ESTOQ              PIC 9(05).
    35     02 PRECO-UNIT-ESTOQ        PIC 9(06)V9(02).
    36
    37 FD  RELESTOQ
    38     LABEL RECORD IS OMITTED
    39     VALUE OF FILE-ID IS "RELESTOQ.TXT".
    40 01  REL-ITEM     PIC X(72).
    41 01  REL-TOT      PIC X(72).
    42
    43 WORKING-STORAGE SECTION.
    44 77  FIM-ARQ        PIC X(03) VALUE "NAO".
    45 77  CT-LIN         PIC 9(02) VALUE 25.
    46 77  CT-PAG         PIC 9(03) VALUE ZEROES.
    47
    48 77  ITEM-TOT-TEMP  PIC 9(08)V9(02) VALUE ZEROES.
    49
    50 77  QTD-PROD-TEMP  PIC 9(07) VALUE ZEROES.
    51 77  PRE-TOT-TEMP   PIC 9(08)V9(02) VALUE ZEROES.
    52 77  PRE-MED-TEMP   PIC 9(06)V9(02) VALUE ZEROES.
    53
    54 01  CAB-01.
    55     02 FILLER  PIC X(06) VALUE "DATA: ".
    56     02 DIA     PIC 9(02) VALUE 22.
    57     02 FILLER  PIC X(01) VALUE "/".
* Microsoft COBOL Version 4.5        L2.4 revision 002 22-Apr-23 16:45 Page   2
*                                       EX04.CBL
    58     02 MES     PIC 9(02) VALUE 04.
    59     02 FILLER  PIC X(01) VALUE "/".
    60     02 ANO     PIC 9(04) VALUE 2023.
    61     02 FILLER  PIC X(03) VALUE SPACES.
    62     02 FILLER  PIC X(22) VALUE "RELATORIO DE MATERIAL ".
    63     02 FILLER  PIC X(10) VALUE "EM ESTOQUE".
    64     02 FILLER  PIC X(13) VALUE SPACES.
    65     02 FILLER  PIC X(05) VALUE "PAG. ".
    66     02 VAR-PAG PIC 9(03).
    67
    68 01  CAB-02.
    69     02 FILLER PIC X(06) VALUE "CODIGO".
    70     02 FILLER PIC X(04) VALUE SPACES.
    71     02 FILLER PIC X(04) VALUE "NOME".
    72     02 FILLER PIC X(09) VALUE SPACES.
    73     02 FILLER PIC X(07) VALUE "QTDE DO".
    74     02 FILLER PIC X(02) VALUE SPACES.
    75     02 FILLER PIC X(15) VALUE "CUSTO-UNITARIO".
    76     02 FILLER PIC X(02) VALUE SPACES.
    77     02 FILLER PIC X(15) VALUE "CUSTO-TOTAL".
    78
    79 01  CAB-02A.
    80     02 FILLER PIC X(23) VALUE SPACES.
    81     02 FILLER PIC X(07) VALUE "ESTOQUE".
    82     02 FILLER PIC X(34) VALUE SPACES.
    83
    84 01  DETALHE.
    85     02 CODIGO    PIC 9(05).
    86     02 FILLER    PIC X(02) VALUE SPACES.
    87     02 NOME      PIC X(15).
    88     02 QTD-ITEM  PIC Z99.999.
    89     02 FILLER    PIC X(04) VALUE SPACES.
    90     02 CUSTO-UNI PIC Z999.999,99.
    91     02 FILLER    PIC X(04) VALUE SPACES.
    92     02 CUSTO-TOT PIC Z9.999.999,99.
    93
    94 01  CAB-03.
    95     02 FILLER PIC X(16) VALUE "QUANTIDADE TOTAL".
    96     02 FILLER PIC X(12) VALUE SPACES.
    97     02 FILLER PIC X(11) VALUE "PRECO MEDIO".
    98     02 FILLER PIC X(5) VALUE SPACES.
    99     02 FILLER PIC X(11) VALUE "PRECO TOTAL".
   100
   101 01  TOTAL-ESTOQS.
   102     02 FILLER         PIC X(03) VALUE SPACES.
   103     02 QTD-ESTOQS     PIC Z9.999.999 VALUE ZEROES.
   104     02 FILLER         PIC X(14) VALUE SPACES.
   105     02 PRE-MED-ESTOQS PIC Z999.999,99 VALUE ZEROES.
   106     02 FILLER         PIC X(05) VALUE SPACES.
   107     02 PRE-TOT-ESTOQS PIC Z99.999.999,99 VALUE ZEROES.
   108
   109 PROCEDURE DIVISION.
   110
   111 MAIN.
   112     PERFORM INICIO.
   113     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
   114     PERFORM FIM.
   115     STOP RUN.
* Microsoft COBOL Version 4.5        L2.4 revision 002 22-Apr-23 16:45 Page   3
*                                       EX04.CBL
   116
   117 INICIO.
   118     OPEN INPUT  CADESTOQ
   119          OUTPUT RELESTOQ.
   120     PERFORM LEITURA.
   121
   122 LEITURA.
   123     READ CADESTOQ AT END MOVE "SIM" TO FIM-ARQ.
   124
   125 ATUALIZA-PAG.
   126     ADD 1         TO CT-PAG.
   127     MOVE CT-PAG   TO VAR-PAG.
   128
   129 CABECALHO-ITEM.
   130     PERFORM ATUALIZA-PAG.
   131     MOVE SPACES   TO REL-ITEM.
   132
   133     IF CT-PAG = 1
   134         WRITE REL-ITEM FROM CAB-01
   135     ELSE WRITE REL-ITEM FROM CAB-01 AFTER ADVANCING 4 LINE.
   136
   137     WRITE REL-ITEM FROM CAB-02 AFTER ADVANCING 2 LINE.
   138     WRITE REL-ITEM FROM CAB-02A AFTER ADVANCING 1 LINE.
   139
   140     MOVE ZEROES TO CT-LIN.
   141
   142 IMPRESSAO.
   143     IF CT-LIN EQUAL 25
   144         PERFORM CABECALHO-ITEM.
   145
   146     MOVE CODIGO-ESTOQ     TO CODIGO.
   147     MOVE NOME-ESTOQ       TO NOME.
   148     MOVE QTDE-ESTOQ       TO QTD-ITEM.
   149     MOVE PRECO-UNIT-ESTOQ TO CUSTO-UNI.
   150
   151     MULTIPLY PRECO-UNIT-ESTOQ BY QTDE-ESTOQ GIVING ITEM-TOT-TEMP.
   152     MOVE ITEM-TOT-TEMP TO CUSTO-TOT.
   153
   154     ADD 1                 TO CT-LIN.
   155     ADD QTDE-ESTOQ        TO QTD-PROD-TEMP.
   156     ADD ITEM-TOT-TEMP     TO PRE-TOT-TEMP.
   157
   158     WRITE REL-ITEM  FROM DETALHE AFTER ADVANCING 1 LINE.
   159
   160 PRINCIPAL.
   161     PERFORM IMPRESSAO.
   162     PERFORM LEITURA.
   163
   164 IMPRESSAO-FINAL.
   165     PERFORM ATUALIZA-PAG.
   166
   167     MOVE QTD-PROD-TEMP TO QTD-ESTOQS.
   168
   169     DIVIDE PRE-TOT-TEMP BY QTD-PROD-TEMP
   170        GIVING PRE-MED-TEMP.
   171     MOVE PRE-MED-TEMP TO PRE-MED-ESTOQS.
   172
   173     MOVE PRE-TOT-TEMP TO PRE-TOT-ESTOQS.
* Microsoft COBOL Version 4.5        L2.4 revision 002 22-Apr-23 16:45 Page   4
*                                       EX04.CBL
   174
   175     WRITE REL-TOT FROM CAB-01 AFTER ADVANCING 4 LINE.
   176     WRITE REL-TOT FROM CAB-03 AFTER ADVANCING 3 LINE.
   177     WRITE REL-TOT FROM TOTAL-ESTOQS AFTER ADVANCING 2 LINE.
   178
   179 FIM.
   180     PERFORM IMPRESSAO-FINAL.
   181     CLOSE CADESTOQ RELESTOQ.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1520     Code:         784     Dictionary:        2285
