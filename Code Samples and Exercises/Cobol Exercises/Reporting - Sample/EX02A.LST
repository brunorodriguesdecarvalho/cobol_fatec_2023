* Microsoft COBOL Version 4.5        L2.4 revision 002 19-Jun-23 12:55 Page   1
*                                      EX02A.CBL
* Options: LIST(EX02A.LST) ASMLIST(EX02A.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. EX02A.
     3 AUTHOR. BRUNO CARVALHO.
     4 INSTALLATION.  BRUNO-PC.
     5 DATE-WRITTEN.  19/06/2023.
     6 DATE-COMPILED. 19-Jun-23 12:55.
     7 SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8
     9 ENVIRONMENT DIVISION.
    10 CONFIGURATION SECTION.
    11 SOURCE-COMPUTER. BRUNO-PC.
    12 OBJECT-COMPUTER. BRUNO-PC.
    13 SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    14
    15 INPUT-OUTPUT SECTION.
    16 FILE-CONTROL.
    17     SELECT CADANT ASSIGN TO "CADANT.DAT"
    18     ORGANIZATION IS LINE SEQUENTIAL.
    19
    20     SELECT ARQMOV ASSIGN TO "ARQMOV.DAT"
    21     ORGANIZATION IS LINE SEQUENTIAL.
    22
    23     SELECT CADATU ASSIGN TO "CADATU.DAT"
    24     ORGANIZATION IS LINE SEQUENTIAL.
    25
    26     SELECT RELOCORR ASSIGN TO "RELOCORR.TXT".
    27
    28 DATA DIVISION.
    29 FILE SECTION.
    30
    31 FD CADANT
    32     LABEL RECORD ARE STANDARD.
    33 01 CADANT-REC.
    34     02 CADANT-COD PIC 9(04).
    35     02 CADANT-NOME PIC X(30).
    36
    37 FD ARQMOV
    38     LABEL RECORD ARE STANDARD.
    39 01 ARQMOV-REC.
    40     02 ARQMOV-COD PIC 9(04).
    41     02 ARQMOV-NOME PIC X(30).
    42
    43 FD CADATU
    44     LABEL RECORD ARE STANDARD.
    45 01 CADATU-REC.
    46     02 CADATU-COD PIC 9(04).
    47     02 CADATU-NOME PIC X(30).
    48
    49 FD RELOCORR
    50     LABEL RECORD IS OMITTED.
    51 01 RELOCORR-REC.
    52     02 RELOCORR-MENSAGEM PIC X(80).
    53
    54 WORKING-STORAGE SECTION.
    55 01 WS-COD-CADANT PIC 9(04).
    56 01 WS-COD-ARQMOV PIC 9(04).
    57 01 CADANT-EOF PIC X(01) VALUE 'N'.
* Microsoft COBOL Version 4.5        L2.4 revision 002 19-Jun-23 12:55 Page   2
*                                      EX02A.CBL
    58 01 ARQMOV-EOF PIC X(01) VALUE 'N'.
    59
    60
    61 PROCEDURE DIVISION.
    62 PGM-BALANCE-LINE.
    63     PERFORM INICIO.
    64     PERFORM BALANCE-LINE.
    65     PERFORM FIM.
    66     STOP RUN.
    67
    68 INICIO.
    69     OPEN INPUT CADANT, ARQMOV
    70         OUTPUT CADATU, RELOCORR.
    71
    72 BALANCE-LINE.
    73     PERFORM LER-CADANT
    74     PERFORM LER-ARQMOV
    75     UNTIL CADANT-EOF EQUAL 'Y' OR ARQMOV-EOF EQUAL 'Y'.
    76
    77 LER-CADANT.
    78     READ CADANT
    79         AT END MOVE 'Y' TO CADANT-EOF.
    80
    81 LER-ARQMOV.
    82     READ ARQMOV
    83         AT END MOVE 'Y' TO ARQMOV-EOF.
    84
    85     IF CADANT-EOF EQUAL 'N' AND ARQMOV-EOF EQUAL 'N'
    86         MOVE CADANT-COD TO WS-COD-CADANT
    87         MOVE ARQMOV-COD TO WS-COD-ARQMOV
    88         PERFORM VERIFICAR-CODIGOS.
    89
    90 VERIFICAR-CODIGOS.
    91     IF WS-COD-CADANT EQUAL WS-COD-ARQMOV
    92         PERFORM GRAVAR-CADATU
    93         PERFORM LER-CADANT
    94         PERFORM LER-ARQMOV
    95     ELSE IF WS-COD-CADANT < WS-COD-ARQMOV
    96         PERFORM GRAVAR-CADATU
    97         PERFORM LER-CADANT
    98     ELSE
    99         PERFORM GRAVAR-CADATU
   100         PERFORM LER-ARQMOV.
   101
   102 GRAVAR-CADATU.
   103     MOVE WS-COD-CADANT TO CADATU-COD
   104     MOVE CADANT-NOME TO CADATU-NOME
   105     WRITE CADATU-REC.
   106
   107 VERIFICAR-CODIGO-EXTRA.
   108     IF CADANT-EOF = 'N'
   109         PERFORM GRAVAR-RELOCORR-CADANT
   110     IF ARQMOV-EOF = 'N'
   111         PERFORM GRAVAR-RELOCORR-ARQMOV.
   112
   113 GRAVAR-RELOCORR-CADANT.
   114     MOVE "Ocorrência no CADANT: " TO RELOCORR-MENSAGEM
   115     MOVE WS-COD-CADANT TO RELOCORR-MENSAGEM(25:4)
* Microsoft COBOL Version 4.5        L2.4 revision 002 19-Jun-23 12:55 Page   3
*                                      EX02A.CBL
   116     WRITE RELOCORR-REC.
   117
   118 GRAVAR-RELOCORR-ARQMOV.
   119     MOVE "Ocorrência no ARQMOV: " TO RELOCORR-MENSAGEM
   120     MOVE WS-COD-ARQMOV TO RELOCORR-MENSAGEM(26:4)
   121     WRITE RELOCORR-REC.
   122
   123 FIM.
   124     CLOSE CADANT, ARQMOV, CADATU, RELOCORR.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1304     Code:         702     Dictionary:        1994
