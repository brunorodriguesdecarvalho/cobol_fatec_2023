* Microsoft COBOL Version 4.5        L2.4 revision 002 28-May-23 21:23 Page   1
*                                       EX03.CBL
* Options: LIST(EX03.LST) ASMLIST(EX03.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. EX03.
     3 AUTHOR. BRUNO CARVALHO.
     4 INSTALLATION. BRUNO-PC.
     5 DATE-WRITTEN. 28/05/2023.
     6 DATE-COMPILED. 28-May-23 21:23.
     7 SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8
     9 ENVIRONMENT DIVISION.
    10 CONFIGURATION SECTION.
    11 SOURCE-COMPUTER. IBM-PC.
    12 OBJECT-COMPUTER. IBM-PC.
    13 SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    14
    15 INPUT-OUTPUT SECTION.
    16 FILE-CONTROL.
    17     SELECT CADENT ASSIGN TO DISK
    18     ORGANIZATION IS LINE SEQUENTIAL.
    19
    20     SELECT ARQORD ASSIGN TO DISK.
    21
    22     SELECT CADSAI ASSIGN TO DISK
    23     ORGANIZATION IS LINE SEQUENTIAL.
    24
    25 DATA DIVISION.
    26 FILE SECTION.
    27
    28 FD CADENT
    29     LABEL RECORDS ARE STANDARD
    30     VALUE OF FILE-ID IS "CADENT.DAT".
    31 01 CAD-ENT.
    32     02 CODIGO-ENT PIC 9(05).
    33     02 NOME-ENT   PIC X(30).
    34     02 DPTO-ENT   PIC 9(02).
    35
    36 SD ARQORD.
    37 01 SORTED.
    38     02 CODIGO-SORT PIC 9(05).
    39     02 NOME-SORT   PIC X(30).
    40     02 DPTO-SORT   PIC 9(02).
    41
    42 FD CADSAI
    43     LABEL RECORDS ARE STANDARD
    44     VALUE OF FILE-ID IS "CADSAI.DAT".
    45 01 CAD-SAI.
    46     02 CODIGO-SAI PIC 9(05).
    47     02 NOME-SAI   PIC X(30).
    48
    49 WORKING-STORAGE SECTION.
    50 77 FIM-ARQ PIC X(03) VALUE "NAO".
    51
    52 PROCEDURE DIVISION.
    53
    54 PGM-EX03.
    55     SORT ARQORD
    56          ASCENDING KEY CODIGO-SORT
    57          USING CADENT
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-May-23 21:23 Page   2
*                                       EX03.CBL
    58          OUTPUT PROCEDURE ROT-SAIDA.
    59     STOP RUN.
    60
    61 ROT-SAIDA SECTION.
    62     PERFORM INICIO.
    63     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    64     PERFORM FIM.
    65
    66 INICIO SECTION.
    67     OPEN OUTPUT CADSAI.
    68     PERFORM LE-SORT.
    69
    70 LE-SORT SECTION.
    71     RETURN ARQORD AT END MOVE "SIM" TO FIM-ARQ.
    72
    73 PRINCIPAL SECTION.
    74     PERFORM SELECAO.
    75     PERFORM LE-SORT.
    76
    77 SELECAO SECTION.
    78     IF DPTO-SORT EQUAL "01" OR DPTO-SORT EQUAL "02"
    79         PERFORM GRAVACAO.
    80
    81 GRAVACAO SECTION.
    82     MOVE CODIGO-SORT TO CODIGO-SAI.
    83     MOVE NOME-SORT TO NOME-SAI.
    84     WRITE CAD-SAI.
    85
    86 FIM SECTION.
    87     CLOSE CADSAI.
    88
    89
    90
    91
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1260     Code:         517     Dictionary:        1549
