* Microsoft COBOL Version 4.5        L2.4 revision 002 22-Apr-23 14:15 Page   1
*                                       EX03.CBL
* Options: LIST(EX03.LST) ASMLIST(EX03.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. EX03.
     3 AUTHOR. BRUNO CARVALHO.
     4 DATE-WRITTEN. 22/04/2023.
     5 DATE-COMPILED. 22-Apr-23 14:15.
     6 INSTALLATION. BRUNO-PC.
     7 SECURITY. ESSE PROGRAMA SO PODE SER ALTERADO PELO AUTOR.
     8
     9 ENVIRONMENT DIVISION.
    10
    11 CONFIGURATION SECTION.
    12 SOURCE-COMPUTER. BRUNO-PC.
    13 OBJECT-COMPUTER. BRUNO-PC.
    14 SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    15
    16 INPUT-OUTPUT SECTION.
    17
    18 FILE-CONTROL.
    19     SELECT CADENT ASSIGN TO DISK
    20     ORGANIZATION IS LINE SEQUENTIAL.
    21
    22     SELECT RELSAI ASSIGN TO DISK.
    23
    24 DATA DIVISION.
    25
    26 FILE SECTION.
    27
    28 FD  CADENT
    29     LABEL RECORD ARE STANDARD
    30     VALUE OF FILE-ID IS "CADENT.DAT".
    31 01  CADENT1.
    32     02 CODIGO-CLIENTE      PIC 9(07).
    33     02 NOME-CLIENTE        PIC X(30).
    34     02 SALARIO-CLIENTE     PIC 9(05)V9(02).
    35     02 SEXO                PIC X(01).
    36
    37 FD  RELSAI
    38     LABEL RECORD IS OMITTED
    39     VALUE OF FILE-ID IS "RELSAI.TXT".
    40 01  REL-ITEM     PIC X(72).
    41 01  REL-CLI-IMP  PIC X(72).
    42 01  REL-SAL      PIC X(72).
    43
    44 WORKING-STORAGE SECTION.
    45 77  FIM-ARQ       PIC X(03) VALUE "NAO".
    46 77  CT-LIN        PIC 9(02) VALUE 20.
    47 77  CT-PAG        PIC 9(03) VALUE ZEROES.
    48 77  QTD-CLI-TEMP  PIC 9(05) VALUE ZEROES.
    49 77  SUM-SAL-TEMP  PIC 9(09)V9(02) VALUE ZEROES.
    50
    51 01  CAB-01.
    52     02 FILLER  PIC X(54) VALUE SPACES.
    53     02 FILLER  PIC X(05) VALUE "PAG. ".
    54     02 VAR-PAG PIC 99(03).
    55     02 FILLER  PIC X(2) VALUE SPACES.
    56
    57 01  CAB-02.
* Microsoft COBOL Version 4.5        L2.4 revision 002 22-Apr-23 14:15 Page   2
*                                       EX03.CBL
    58     02 FILLER  PIC X(12) VALUE SPACES.
    59     02 FILLER  PIC X(22) VALUE "LISTAGEM DOS CLIENTES ".
    60     02 FILLER  PIC X(16) VALUE "DO SEXO FEMININO".
    61     02 FILLER  PIC X(12) VALUE SPACES.
    62
    63 01  CAB-03.
    64     02 FILLER PIC X(14) VALUE SPACES.
    65     02 FILLER PIC X(24) VALUE "COM SALARIOS SUPERIORES ".
    66     02 FILLER PIC X(10) VALUE "A 5.000,00".
    67     02 FILLER PIC X(24) VALUE SPACES.
    68
    69 01  CAB-04.
    70     02 FILLER PIC X(04) VALUE SPACES.
    71     02 FILLER PIC X(08) VALUE " CODIGO ".
    72     02 FILLER PIC X(05) VALUE SPACES.
    73     02 FILLER PIC X(08) VALUE "  NOME  ".
    74     02 FILLER PIC X(31) VALUE SPACES.
    75     02 FILLER PIC X(07) VALUE "SALARIO".
    76     02 FILLER PIC X(13) VALUE SPACES.
    77
    78 01  DETALHE.
    79     02 FILLER      PIC X(5) VALUE SPACES.
    80     02 CODIGO      PIC 9(07).
    81     02 FILLER      PIC X(05) VALUE SPACES.
    82     02 NOME        PIC X(30).
    83     02 FILLER      PIC X(08) VALUE SPACES.
    84     02 SALARIO     PIC Z99.999,99.
    85
    86 01  TOTAL-CLIENTES.
    87     02 FILLER   PIC X(29) VALUE "Total de Clientes impressos: ".
    88     02 FILLER       PIC X(08) VALUE SPACES.
    89     02 QTD-CLIENTES PIC Z99.999 VALUE ZEROES.
    90
    91 01  TOTAL-SALARIO.
    92     02 FILLER      PIC X(18) VALUE "Total de Salario: ".
    93     02 FILLER      PIC X(11) VALUE SPACES.
    94     02 SUM-SALARIO PIC Z999.999.999,99 VALUE ZEROES.
    95
    96 PROCEDURE DIVISION.
    97
    98 MAIN.
    99     PERFORM INICIO.
   100     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
   101     PERFORM FIM.
   102     STOP RUN.
   103
   104 INICIO.
   105     OPEN INPUT  CADENT
   106          OUTPUT RELSAI.
   107     PERFORM LEITURA.
   108
   109 LEITURA.
   110     READ CADENT AT END MOVE "SIM" TO FIM-ARQ.
   111
   112 CABECALHO.
   113     ADD 1         TO CT-PAG.
   114     MOVE CT-PAG   TO VAR-PAG.
   115     MOVE SPACES   TO REL-ITEM.
* Microsoft COBOL Version 4.5        L2.4 revision 002 22-Apr-23 14:15 Page   3
*                                       EX03.CBL
   116
   117     IF CT-PAG = 1
   118         WRITE REL-ITEM FROM CAB-01
   119     ELSE WRITE REL-ITEM FROM CAB-01 AFTER ADVANCING 4 LINE.
   120     WRITE REL-ITEM FROM CAB-02 AFTER ADVANCING 1 LINE.
   121     WRITE REL-ITEM FROM CAB-03 AFTER ADVANCING 1 LINE.
   122     WRITE REL-ITEM FROM CAB-04 AFTER ADVANCING 3 LINE.
   123
   124     MOVE ZEROES   TO CT-LIN.
   125
   126 IMPRESSAO.
   127     IF CT-LIN EQUAL 20
   128         PERFORM CABECALHO.
   129
   130     MOVE CODIGO-CLIENTE   TO CODIGO.
   131     MOVE NOME-CLIENTE     TO NOME.
   132     MOVE SALARIO-CLIENTE  TO SALARIO.
   133     ADD 1                 TO CT-LIN.
   134
   135     IF CT-LIN EQUAL 1
   136         WRITE REL-ITEM  FROM DETALHE AFTER ADVANCING 2 LINE
   137     ELSE WRITE REL-ITEM FROM DETALHE AFTER ADVANCING 1 LINE.
   138
   139 PRINCIPAL.
   140     IF SEXO = 'F' AND SALARIO-CLIENTE > 5000
   141        ADD 1 TO QTD-CLI-TEMP
   142        ADD SALARIO-CLIENTE TO SUM-SAL-TEMP
   143        PERFORM IMPRESSAO.
   144     PERFORM LEITURA.
   145
   146 IMPRESSAO-FINAL.
   147     MOVE QTD-CLI-TEMP TO QTD-CLIENTES.
   148     MOVE SUM-SAL-TEMP TO SUM-SALARIO.
   149     WRITE REL-CLI-IMP FROM TOTAL-CLIENTES AFTER ADVANCING 4 LINE.
   150     WRITE REL-SAL     FROM TOTAL-SALARIO AFTER ADVANCING 1 LINE.
   151
   152 FIM.
   153     PERFORM IMPRESSAO-FINAL.
   154     CLOSE CADENT RELSAI.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1584     Code:         782     Dictionary:        2029
