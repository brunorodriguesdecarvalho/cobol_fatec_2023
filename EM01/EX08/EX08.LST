* Microsoft COBOL Version 4.5        L2.4 revision 002 11-Mar-23 10:15 Page   1
*                                       EX08.CBL
* Options: LIST(EX08.LST) ASMLIST(EX08.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. EX08.
     3 AUTHOR. BRUNO RODRIGUES DE CARVALHO.
     4 INSTALLATION. FATEC-SP.
     5 DATE-WRITTEN. 11/03/2022.
     6 DATE-COMPILED. 11-Mar-23 10:15.
     7
     8 ENVIRONMENT DIVISION.
     9
    10 CONFIGURATION SECTION.
    11 SOURCE-COMPUTER. BRUNO-NOTEBOOK.
    12 OBJECT-COMPUTER. BRUNO-NOTEBOOK.
    13 SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    14
    15 INPUT-OUTPUT SECTION.
    16
    17 FILE-CONTROL.
    18
    19     SELECT CADFUN ASSIGN TO DISK
    20     ORGANIZATION IS LINE SEQUENTIAL.
    21
    22     SELECT CADSAI ASSIGN TO DISK
    23     ORGANIZATION IS LINE SEQUENTIAL.
    24
    25 DATA DIVISION.
    26
    27 FILE SECTION.
    28 FD CADFUN
    29     LABEL RECORD ARE STANDARD
    30     VALUE OF FILE-ID IS "CADFUN.DAT".
    31
    32 01 REG-ENT.
    33     02 CODIGO-ENT PIC 9(05).
    34     02 NOME-ENT PIC X(20).
    35     02 SALARIO-BRUTO PIC 9(05)V99.
    36
    37 FD CADSAI
    38     LABEL RECORD ARE STANDARD
    39     VALUE OF FILE-ID IS "CADSAI.DAT".
    40
    41 01 REG-SAI.
    42     02 CODIGO-SAI PIC 9(05).
    43     02 NOME-SAI PIC X(20).
    44     02 SALARIO-REAJUSTADO PIC 9(05)V99.
    45
    46 WORKING-STORAGE SECTION.
    47
    48 77 FIM-ARQ PIC X(03) VALUE "NAO".
    49
    50 PROCEDURE DIVISION.
    51
    52     PERFORM INICIO.
    53     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    54     PERFORM TERMINO.
    55
    56     STOP RUN.
    57
* Microsoft COBOL Version 4.5        L2.4 revision 002 11-Mar-23 10:15 Page   2
*                                       EX08.CBL
    58 INICIO.
    59     OPEN INPUT CADFUN OUTPUT CADSAI.
    60     PERFORM LEITURA.
    61
    62 LEITURA.
    63     READ CADFUN
    64     AT END MOVE "SIM" TO FIM-ARQ.
    65
    66 PRINCIPAL.
    67     PERFORM CALCULO.
    68     PERFORM GRAVACAO.
    69     PERFORM LEITURA.
    70
    71 CALCULO.
    72     IF SALARIO-BRUTO IS LESS THAN OR EQUAL TO 1000
    73        COMPUTE SALARIO-REAJUSTADO = SALARIO-BRUTO * 1,12
    74     ELSE IF SALARIO-BRUTO IS LESS OR EQUAL TO 2000
    75        COMPUTE SALARIO-REAJUSTADO = SALARIO-BRUTO * 1,11
    76     ELSE IF SALARIO-BRUTO IS GREATER THAN 2000
    77        COMPUTE SALARIO-REAJUSTADO = SALARIO-BRUTO * 1,10.
    78
    79 GRAVACAO.
    80     MOVE CODIGO-ENT TO CODIGO-SAI.
    81     MOVE NOME-ENT TO NOME-SAI.
    82     WRITE REG-SAI.
    83
    84 TERMINO.
    85     CLOSE CADFUN CADSAI.
    86
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1032     Code:         406     Dictionary:        1092
