* Microsoft COBOL Version 4.5        L2.4 revision 002 17-Mar-23 23:05 Page   1
*                                       GET.CBL
* Options: LIST(GET.LST) ASMLIST(GET.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. MY-PROGRAM.
     3 ENVIRONMENT DIVISION.
     4 CONFIGURATION SECTION.
     5 SOURCE-COMPUTER. IBM-PC.
     6 OBJECT-COMPUTER. IBM-PC.
     7 INPUT-OUTPUT SECTION.
     8 FILE-CONTROL.
     9 DATA DIVISION.
    10 WORKING-STORAGE SECTION.
    11 01 SERVER-ADDRESS PIC X(20) VALUE 'www.example.com'.
    12 01 SERVER-PORT PIC S9(4) COMP VALUE 80.
    13 01 HTTP-REQUEST PIC X(500) VALUE SPACES.
    14 01 HTTP-RESPONSE PIC X(2000) VALUE SPACES.
    15 01 SOCKET-HANDLE PIC S9(8) COMP VALUE -1.
    16 01 BYTES-RECEIVED PIC S9(8) COMP VALUE 0.
    17 01 SOCKET-ADDRESS.
    18     05 FAMILY PIC S9(8) COMP VALUE 2.
    19     05 PORT PIC S9(8) COMP VALUE 0.
    20     05 ADDRESS PIC X(4) VALUE X'00000000'.
* 233-S**************                                                  (   0)**
**    Unknown data description qualifier
    21 PROCEDURE DIVISION.
    22 MAIN-LOGIC SECTION.
    23     DISPLAY 'Creating socket...'.
    24     CALL "SOCKET" USING AF-INET, SOCK-STREAM, 0, SOCKET-HANDLE.
*  12-S*******************************                                 (   1)**
**    Operand  is not declared
    25     DISPLAY 'Resolving server address...'.
    26     CALL "GETHOSTBYNAME" USING BY VALUE SERVER-ADDRESS, BY REFERE
*  11-S****************************************************************(   1)**
**    Reserved word missing or incorrectly used
    27     MOVE SERVER-PORT TO SOCKET-ADDRESS-PORT
*  12-S*******************************************                     (   1)**
**    Operand  is not declared
    28     DISPLAY 'Connecting to server...'
    29     CALL "CONNECT" USING SOCKET-HANDLE, SOCKET-ADDRESS, LENGTH OF
    30     DISPLAY 'Sending request...'
*  13-S***********                                                     (   1)**
**    User-name required
    31     MOVE "GET / HTTP/1.1^M^JHost: www.example.com^M^JConnection:
*1004-E****************************************************************(   1)**
**    Continuation character expected. End of literal assumed.
    32     CALL "SEND" USING SOCKET-HANDLE, ADDRESS OF HTTP-REQUEST, LEN
*  11-S********                                                        (   1)**
**    Reserved word missing or incorrectly used
*  12-S****************************************************************(   1)**
**    Operand  is not declared
    33     DISPLAY 'Receiving response...'
    34     PERFORM UNTIL BYTES-RECEIVED <= 0
    35         CALL "RECV" USING SOCKET-HANDLE, ADDRESS OF HTTP-RESPONSE
    36         IF BYTES-RECEIVED > 0
    37             DISPLAY HTTP-RESPONSE(1:BYTES-RECEIVED)
    38         END-IF
    39     END-PERFORM
    40     DISPLAY 'Closing socket...'
    41     CALL "CLOSE" USING SOCKET-HANDLE
* Microsoft COBOL Version 4.5        L2.4 revision 002 17-Mar-23 23:05 Page   2
*                                       GET.CBL
    42     STOP RUN.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Last message on page:  1
*
* Total Messages:     8
* Unrecoverable :     0                    Severe  :     7
* Errors        :     1                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:        3172     Code:         298     Dictionary:         776
