* Microsoft COBOL Version 4.5        L2.4 revision 002 23-Apr-23 10:01 Page   1
*                                       EX01.CBL
* Options: LIST(EX01.LST) ASMLIST(EX01.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. EX01.
     3 AUTHOR. BRUNO CARVALHO.
     4 INSTALLATION. BRUNO-PC.
     5 DATE-WRITTEN. 21/04/2023.
     6 DATE-COMPILED. 23-Apr-23 10:01.
     7 SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8*REMARKS.    LER REGISTROS E IMPRIMIR RELATORIO.
     9
    10 ENVIRONMENT DIVISION.
    11 CONFIGURATION SECTION.
    12 SOURCE-COMPUTER. BRUNO-PC.
    13 OBJECT-COMPUTER. BRUNO-PC.
    14 SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    15
    16 INPUT-OUTPUT SECTION.
    17 FILE-CONTROL.
    18     SELECT CADSOC1 ASSIGN TO DISK
    19     ORGANIZATION IS LINE SEQUENTIAL.
    20
    21     SELECT REL-ATR ASSIGN TO DISK.
    22
    23     SELECT CADSOC2 ASSIGN TO DISK
    24     ORGANIZATION IS LINE SEQUENTIAL.
    25
    26 DATA DIVISION.
    27 FILE SECTION.
    28
    29 FD  CADSOC1
    30     LABEL RECORD ARE STANDARD
    31     VALUE OF FILE-ID IS "CADSOC1.DAT".
    32 01  CAD-SOC1.
    33     02 CODIGO-PAGAMENTO1 PIC 9(02).
    34     02 NUMERO-SOCIO1     PIC 9(06).
    35     02 NOME-SOCIO1       PIC X(30).
    36     02 VALOR-PAGAMENTO1  PIC 9(09)V9(02).
    37
    38 FD  REL-ATR
    39     LABEL RECORD IS OMITTED
    40     VALUE OF FILE-ID IS "RELSOCIO.txt".
    41 01  REG-ATR    PIC X(80).
    42 01  QTD-ATRAS  PIC X(80).
    43 01  SUM-ATRAS  PIC X(80).
    44
    45 FD  CADSOC2
    46     LABEL RECORD ARE STANDARD
    47     VALUE OF FILE-ID IS "CADSOC2.DAT".
    48 01  CAD-SOC2.
    49     02 NUMERO-SOCIO2     PIC 9(06).
    50     02 NOME-SOCIO2       PIC X(30).
    51     02 VALOR-PAGAMENTO2  PIC 9(09)V9(02).
    52
    53 WORKING-STORAGE SECTION.
    54 77  FIM-ARQ         PIC X(03) VALUE "NAO".
    55 77  CT-LIN          PIC 9(02) VALUE 30.
    56 77  CT-PAG          PIC 9(02) VALUE ZEROES.
    57 77  TEMP-VAL-ATR    PIC 9(12)V9(06) VALUE ZEROES.
* Microsoft COBOL Version 4.5        L2.4 revision 002 23-Apr-23 10:01 Page   2
*                                       EX01.CBL
    58
    59 01 CAB-01.
    60     02 FILLER  PIC X(65) VALUE SPACES.
    61     02 FILLER  PIC X(05) VALUE "PAG. ".
    62     02 VAR-PAG PIC 99.
    63     02 FILLER  PIC X(03) VALUE SPACES.
    64
    65 01 CAB-02.
    66     02 FILLER  PIC X(21) VALUE SPACES.
    67     02 FILLER  PIC X(30) VALUE "RELATORIO DE SOCIOS ATRASADOS ".
    68     02 FILLER  PIC X(21) VALUE SPACES.
    69
    70 01 CAB-03.
    71     02 FILLER  PIC X(15) VALUE "NUMERO DO SOCIO".
    72     02 FILLER  PIC X(10)  VALUE SPACES.
    73     02 FILLER  PIC X(15) VALUE "NOME DO SOCIO".
    74     02 FILLER  PIC X(14) VALUE SPACES.
    75     02 FILLER  PIC X(18) VALUE "VALOR DO PAGAMENTO".
    76
    77 01 DETALHE.
    78     02 FILLER  PIC X(03) VALUE SPACES.
    79     02 NUM-SOC PIC Z999.999.
    80     02 FILLER  PIC X(13) VALUE SPACES.
    81     02 NOM-SOC PIC X(30).
    82     02 VAL-PAG PIC Z999.999.999,99.
    83
    84 01 QTD-ATRASOS.
    85     02 FILLER PIC X(28) VALUE "Total de Socios atrasados : ".
    86     02 SOC-QTD-ATRAS PIC 9(05).
    87     02 FILLER  PIC X(49) VALUE SPACES.
    88
    89 01 SUM-ATRASOS.
    90     02 FILLER PIC X(30) VALUE "Valor Total atrasado      : R$".
    91     02 SOC-SUM-ATRAS PIC Z999.999.999.999,99.
    92     02 FILLER  PIC X(28) VALUE SPACES.
    93
    94 PROCEDURE DIVISION.
    95
    96 EXEMPLO-IMPRESSAO.
    97     PERFORM INICIO.
    98     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    99     PERFORM IMPRESSAO-FINAL.
   100     PERFORM FIM.
   101     STOP RUN.
   102
   103 INICIO.
   104     OPEN INPUT CADSOC1
   105          OUTPUT CADSOC2 REL-ATR.
   106     PERFORM LEITURA.
   107
   108 LEITURA.
   109     READ CADSOC1 AT END MOVE "SIM" TO FIM-ARQ.
   110
   111 PRINCIPAL.
   112     IF CODIGO-PAGAMENTO1 = 02
   113        PERFORM IMPRESSAO.
   114     IF CODIGO-PAGAMENTO1 = 01
   115        PERFORM GRAVACAO.
* Microsoft COBOL Version 4.5        L2.4 revision 002 23-Apr-23 10:01 Page   3
*                                       EX01.CBL
   116     PERFORM LEITURA.
   117
   118 CABECALHO.
   119     ADD 1        TO CT-PAG.
   120     MOVE CT-PAG  TO VAR-PAG.
   121     MOVE SPACES  TO REG-ATR.
   122     WRITE REG-ATR FROM CAB-01 AFTER ADVANCING 2 LINE.
   123     WRITE REG-ATR FROM CAB-02 AFTER ADVANCING 3 LINE.
   124     WRITE REG-ATR FROM CAB-03 AFTER ADVANCING 2 LINE.
   125     MOVE ZEROES  TO CT-LIN.
   126
   127
   128 IMPRESSAO.
   129     IF CT-LIN EQUAL 30
   130        PERFORM CABECALHO.
   131
   132     MOVE NUMERO-SOCIO1 TO NUM-SOC.
   133     MOVE NOME-SOCIO1 TO NOM-SOC.
   134     MOVE VALOR-PAGAMENTO1 TO VAL-PAG.
   135
   136     ADD 1 TO CT-LIN.
   137     ADD 1 TO SOC-QTD-ATRAS.
   138     ADD VALOR-PAGAMENTO1 TO TEMP-VAL-ATR.
   139
   140     IF CT-LIN EQUAL 1
   141        WRITE REG-ATR FROM DETALHE AFTER ADVANCING 2 LINE
   142        ELSE WRITE REG-ATR FROM DETALHE AFTER ADVANCING 1 LINE.
   143
   144 GRAVACAO.
   145     MOVE NUMERO-SOCIO1 TO NUMERO-SOCIO2
   146     MOVE NOME-SOCIO1 TO NOME-SOCIO2
   147     MOVE VALOR-PAGAMENTO1 TO VALOR-PAGAMENTO2
   148     WRITE CAD-SOC2.
   149
   150 IMPRESSAO-FINAL.
   151     WRITE QTD-ATRAS FROM QTD-ATRASOS AFTER ADVANCING 2 LINE.
   152     MOVE TEMP-VAL-ATR TO SOC-SUM-ATRAS.
   153     WRITE SUM-ATRAS FROM SUM-ATRASOS AFTER ADVANCING 1 LINE.
   154
   155 FIM.
   156     CLOSE CADSOC1 REL-ATR CADSOC2.
   157
   158
   159
   160
   161
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1828     Code:         827     Dictionary:        2337
