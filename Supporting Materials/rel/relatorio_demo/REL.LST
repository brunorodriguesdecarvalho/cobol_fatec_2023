* Microsoft COBOL Version 4.5        L2.4 revision 002 21-Apr-23 09:17 Page   1
*                                       REL.CBL
* Options: LIST(REL.LST) ASMLIST(REL.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. IMPRIME.
     3 AUTHOR. HIROMASA.
     4 INSTALLATION. FATEC-SP.
     5 DATE-WRITTEN. 27/08/2004.
     6 DATE-COMPILED. 21-Apr-23 09:17.
     7 SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8*REMARKS.  LE UM REGISTRO E IMPRIME UM RELATORIO.
     9
    10 ENVIRONMENT DIVISION.
    11 CONFIGURATION SECTION.
    12 SOURCE-COMPUTER. IBM-PC.
    13 OBJECT-COMPUTER. IBM-PC.
    14 SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    15 INPUT-OUTPUT SECTION.
    16 FILE-CONTROL.
    17     SELECT CAD-USU ASSIGN TO DISK
    18     ORGANIZATION IS LINE SEQUENTIAL.
    19     SELECT REL-ATR ASSIGN TO DISK.
    20
    21 DATA DIVISION.
    22 FILE SECTION.
    23
    24 FD  CAD-USU
    25     LABEL RECORD ARE STANDARD
    26     VALUE OF FILE-ID IS "CAD-USU.DAT".
    27 01  REG-USU.
    28     02 COD-USU   PIC 9(04).
    29     02 NOM-USU   PIC X(30).
    30     02 REG-DATA.
    31        03 DIA    PIC 9(02).
    32        03 MES    PIC 9(02).
    33        03 ANO    PIC 9(04).
    34     02 SIT-USU   PIC 9(01).
    35
    36 FD  REL-ATR
    37     LABEL RECORD IS OMITTED.
    38 01  REG-ATR     PIC X(80).
    39
    40 WORKING-STORAGE SECTION.
    41 77  FIM-ARQ     PIC X(03) VALUE "NAO".
    42 77  CT-LIN      PIC 9(02) VALUE 25.
    43 77  CT-PAG      PIC 9(02) VALUE ZEROES.
    44
    45 01 CAB-01.
    46    02 FILLER    PIC X(70) VALUE SPACES.
    47    02 FILLER    PIC X(05) VALUE "PAG. ".
    48    02 VAR-PAG   PIC 99.
    49    02 FILLER    PIC X(03) VALUE SPACES.
    50
    51 01 CAB-02.
    52    02 FILLER    PIC X(15) VALUE SPACES.
    53    02 FILLER    PIC X(21) VALUE "RELATORIO DE USUARIOS".
    54    02 FILLER    PIC X(01) VALUE SPACES.
    55    02 FILLER    PIC X(19) VALUE "GERAL DA BIBLIOTECA".
    56    02 FILLER    PIC X(24) VALUE SPACES.
    57
* Microsoft COBOL Version 4.5        L2.4 revision 002 21-Apr-23 09:17 Page   2
*                                       REL.CBL
    58 01 CAB-03.
    59    02 FILLER    PIC X(5)  VALUE SPACES.
    60    02 FILLER    PIC X(6)  VALUE "CODIGO".
    61    02 FILLER    PIC X(19) VALUE SPACES.
    62    02 FILLER    PIC X(4)  VALUE "NOME".
    63    02 FILLER    PIC X(20) VALUE SPACES.
    64    02 FILLER    PIC X(21) VALUE "DATA DE CADASTRAMENTO".
    65    02 FILLER    PIC X(5)  VALUE SPACES.
    66
    67 01 DETALHE.
    68    02 FILLER     PIC X(06) VALUE SPACES.
    69    02 COD        PIC 9999.
    70    02 FILLER     PIC X(06) VALUE SPACES.
    71    02 NOM        PIC X(30).
    72    02 FILLER     PIC X(13) VALUE SPACES.
    73    02 DDD        PIC 99.
    74    02 FILLER     PIC X(01) VALUE "/".
    75    02 MMM        PIC 99.
    76    02 FILLER     PIC X(01) VALUE "/".
    77    02 AAA        PIC 9999.
    78    02 FILLER     PIC X(11) VALUE SPACES.
    79
    80 PROCEDURE DIVISION.
    81
    82 EXEMPLO-IMPRESSAO.
    83     PERFORM INICIO.
    84     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    85     PERFORM FIM.
    86     STOP RUN.
    87
    88 INICIO.
    89     OPEN INPUT  CAD-USU
    90          OUTPUT REL-ATR.
    91     PERFORM LEITURA.
    92
    93 LEITURA.
    94     READ CAD-USU AT END MOVE "SIM" TO FIM-ARQ.
    95
    96 PRINCIPAL.
    97     PERFORM IMPRESSAO.
    98
    99 IMPRESSAO.
   100     IF CT-LIN GREATER THAN 24
   101         PERFORM CABECALHO.
   102     PERFORM IMPDET.
   103
   104
   105 IMPDET.
   106     MOVE COD-USU  TO COD.
   107     MOVE NOM-USU  TO NOM.
   108     MOVE DIA      TO DDD.
   109     MOVE MES      TO MMM.
   110     MOVE ANO      TO AAA.
   111     WRITE REG-ATR FROM DETALHE AFTER ADVANCING 1 LINE.
   112     ADD 1         TO CT-LIN.
   113
   114 CABECALHO.
   115     ADD 1         TO CT-PAG.
* Microsoft COBOL Version 4.5        L2.4 revision 002 21-Apr-23 09:17 Page   3
*                                       REL.CBL
   116     MOVE CT-PAG   TO VAR-PAG.
   117     MOVE SPACES   TO REG-ATR.
   118     WRITE REG-ATR AFTER ADVANCING PAGE.
   119     WRITE REG-ATR FROM CAB-01 AFTER ADVANCING 1 LINE.
   120     WRITE REG-ATR FROM CAB-02 AFTER ADVANCING 2 LINES.
   121     WRITE REG-ATR FROM CAB-03 AFTER ADVANCING 2 LINES.
   122     MOVE ZEROES   TO CT-LIN.
   123
   124 FIM.
   125     CLOSE CAD-USU REL-ATR.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1428     Code:         537     Dictionary:        1660
